{% extends "base.html" %}  
{% load static %}

{% block style %}
{% endblock %}

{% block h1 %}
Write linked article for {{umowa.domena}}
{% endblock %}

{% block content %}

<div class="container mt-5">
    <div class="row">
        <div class="col-md-12">
            <div class="card shadow">
                <div class="card-body">
                    <h3>Dostępne zaplecza</h3>
                    <p>Click for additional details</p>
                </div>
                <div class="additional-attributes" style="display: block;padding-top: 0;">
                    <table id="zaplacza-table" data-order='[[ 1, "asc" ]]' style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Linkować</th>
                                <th>Tematyka</th>
                                <th>Adres</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for z in zaplecza %}
                            <tr>
                                <td><input type="checkbox" data-user="{{z.2}}" data-key="{{z.4}}"></td>
                                <td>{{z.0}}</td>
                                <td>{{z.1}}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


    <div class="row">
        <div class="col-md-12">
            <div class="card shadow">
                <div class="card-body">
                    <h3>Frazy z panelu</h3>
                    <p>Click for additional details</p>
                </div>
                <div class="additional-attributes">
                    <table id="frazy-table">
                        <tr>
                            <th>URL</th>
                            <th>Fraza</th>
                            <th>Linki</th>
                        </tr>
                        {% for r in umowa.podstrony %}
                            {% if forloop.counter0|divisibleby:2  %}
                            <tr>
                                <td>{{r}}</td>
                            {% else %}
                                <td>{{r}}</td>
                                <td><input type="number" min="0" max="5" value="0"></td>
                            </tr>
                            {% endif %}
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>



<div class="row">
    <div class="col-md-6">
        <div class="card shadow">
            <div class="card-body">
                <h3 class="card-title">Links</h3>
            </div>
            <div class="additional-attributes">
                <button type="button" id="addlinks">Add links</button>
            </div>
        </div>
    </div>
    

    <div class="col-md-6">
        <div class="card shadow">
            <div class="card-body">
                <h3 class="card-title">Details</h3>
            </div>
            <div class="additional-attributes" id="write-details">
                <form id="writeLinks" type="post">
                    {% csrf_token %}
                    {% if not data.topic %}
                    <div class="form-group">
                        <label class="form-label" for="topic">Articles topic:</label>
                        <input type="text" class="form-control" id="topic" name="topic">
                    </div>
                    {% endif %}
                    <input type="hidden" name="lang" value="{{umowa.lang}}">
                    <div class="form-group">
                        <label class="form-label" for="openai_api_key">OpenAI API key:</label>
                        <input type="text" class="form-control" id="openai_api_key" name="openai_api_key" value="{{user.account.openai_api_key}}">
                    </div>
                    {% comment %} <h6>Articles</h6>
                    <div class="slider-container">
                        <input type="range" id="ArtSlider" class="range-slider" min="1" max="5" value="1" name="a_num">
                        <input type="text" id="ArtSliderValue" class="range-value" value="1" readonly>
                    </div> {% endcomment %}
                    <h6>Paragraphs per article</h6>
                    <div class="slider-container">
                        <input type="range" id="ParagraphsSlider" class="range-slider" min="2" max="8" value="4" name="p_num">
                        <input type="text" id="ParagraphsSliderValue" class="range-value" value="4" readonly>
                    </div>
                    <div class="date-container">
                        <label>Start date</label>
                        <input type="date" value="2005-04-02" id="start_date" name="start_date" style="margin-left: 12px;"/>
                    </div>
                    <h6>Days between articles</h6>
                    <div class="slider-container">
                        <input type="range" id="DaysSlider" class="range-slider" min="2" max="14" value="7" name="days_delta">
                        <input type="text" id="DaysSliderValue" class="range-value" value="7" readonly>
                    </div>
                    <div class="checkbox-container">
                        <label>Publish forward</label>
                        <input type="checkbox" id="forward_delta" class="checkbox" name="forward_delta">
                    </div>
                    <button type="submit">Submit</button>
                </form>
            </div>
            <script src="{% static 'js/zaplecze_categories.js' %}"></script>
        </div>
    </div>
</div>


{% endblock %}

{% block script %}
<script src="{% static 'js/links.js' %}"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
<script>
    $(document).ready(function() {
        let table = new DataTable('#zaplacza-table', {
            paging: false,
            scrollY: "40vh",
            scrollCollapse: true
        });
        $('#zaplacza-table').DataTable().columns.adjust();
    });
</script>
{% endblock %}